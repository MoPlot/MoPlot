<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>One_Way_MoPlot • MoPlot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="One_Way_MoPlot">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MoPlot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/One_Way_MoPlot.html">One_Way_MoPlot</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/MoPlot/MoPlot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>One_Way_MoPlot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MoPlot/MoPlot/blob/HEAD/vignettes/One_Way_MoPlot.Rmd"><code>vignettes/One_Way_MoPlot.Rmd</code></a></small>
      <div class="d-none name"><code>One_Way_MoPlot.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MoPlot/MoPlot">MoPlot</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="moplotoneway">MoPlotOneWay<a class="anchor" aria-label="anchor" href="#moplotoneway"></a>
</h2>
<p><code><a href="../reference/MoPlotOneWay.html">MoPlotOneWay()</a></code> is a function for visualizing the results
of a linear model with one categorical predictor and one numeric
dependent variable. It takes as input a model created with
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> and produces a plot that highlights group means with
their associated uncertainty using bars, and visually emphasizes
significant contrasts through colored lines. Optionally, the raw data
points can be displayed in the plot. A secondary panel shows the model
coefficients, including standardized beta values and effect sizes such
as Cohen’s <em>d</em>, allowing for a clear and informative summary of
the model’s findings. <code><a href="../reference/MoPlotOneWay.html">MoPlotOneWay()</a></code> function supports a
variety of contrast coding schemes for categorical predictors, including
treatment coding (dummy coding), sum to zero coding, Helmert coding,
reverse Helmert coding, polynomial coding, sliding difference coding,
and customized coding.</p>
<div class="section level4">
<h4 id="default-treatment-coding">1 Default Treatment coding<a class="anchor" aria-label="anchor" href="#default-treatment-coding"></a>
</h4>
<p>Treatment coding, or dummy coding is a common way to represent
categorical variables in regression models. It transforms a categorical
predictor with k levels into k − 1 binary (0/1) variables, each
comparing one level to a reference (baseline) category. The following
example uses the classic iris dataset with treatment contrasts and shows
the plot without raw data points or coefficient panel, using a
significance level of 0.05:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MoPlot/MoPlot">MoPlot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using Iris data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.treatment</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MoPlotting</span></span>
<span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">FALSE</span>, coef <span class="op">=</span> <span class="cn">FALSE</span>, siglevel <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; This graphical representation illustrates the linear model, where</span></span>
<span><span class="co">#&gt;  Species is the categorical predictor (represented on the x-axis with its levels),</span></span>
<span><span class="co">#&gt;  and Sepal.Length is the numerical dependent variable (plotted on the y-axis).</span></span>
<span><span class="co">#&gt;  The contrast type applied is treatment, which compares each group mean against</span></span>
<span><span class="co">#&gt;  the baseline mean of setosa (the first level of the predictor).</span></span>
<span><span class="co">#&gt;  Blue dots indicate the expected values (means) for each group, while the error bars</span></span>
<span><span class="co">#&gt;  represent the uncertainty associated with these estimates.</span></span>
<span><span class="co">#&gt;  The dashed purple line marks the baseline expected value.</span></span>
<span><span class="co">#&gt;  Green lines highlight significant contrasts, with a significance threshold of 0.05 for the first type of error.</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-2-1.png" width="1152"></p>
<p>Here is the same plot, but including raw data points and the
coefficient panel, also with a 0.05 significance level:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MoPlotting</span></span>
<span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">TRUE</span>, coef <span class="op">=</span> <span class="cn">TRUE</span>, siglevel <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; This graphical representation illustrates the linear model, where</span></span>
<span><span class="co">#&gt;  Species is the categorical predictor (represented on the x-axis with its levels),</span></span>
<span><span class="co">#&gt;  and Sepal.Length is the numerical dependent variable (plotted on the y-axis).</span></span>
<span><span class="co">#&gt;  The contrast type applied is treatment, which compares each group mean against</span></span>
<span><span class="co">#&gt;  the baseline mean of setosa (the first level of the predictor).</span></span>
<span><span class="co">#&gt;  Blue dots indicate the expected values (means) for each group, while the error bars</span></span>
<span><span class="co">#&gt;  represent the uncertainty associated with these estimates.</span></span>
<span><span class="co">#&gt;  The dashed purple line marks the baseline expected value.</span></span>
<span><span class="co">#&gt;  Green lines highlight significant contrasts, with a significance threshold of 0.05 for the first type of error.</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-3-1.png" width="1152"></p>
</div>
<div class="section level4">
<h4 id="sum-coding">2 Sum coding<a class="anchor" aria-label="anchor" href="#sum-coding"></a>
</h4>
<p>Sum coding is another way to represent categorical variables in
regression models. Unlike treatment coding, sum coding compares each
level to the overall mean rather than a specific reference group. The
following example uses again the iris dataset with sum contrasts,
showing the plot without raw data points or coefficient panel at a
significance level of 0.1</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using Sum coding</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.sum</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MoPlotting</span></span>
<span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">FALSE</span>, coef <span class="op">=</span> <span class="cn">FALSE</span>, siglevel <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="co">#&gt; This graphical representation depicts the linear model, with</span></span>
<span><span class="co">#&gt;  Species as the categorical predictor (levels shown on the x-axis),</span></span>
<span><span class="co">#&gt;  and Sepal.Length as the numerical dependent variable (values displayed on the y-axis).</span></span>
<span><span class="co">#&gt;  The contrast type is sum, where each group mean is compared to</span></span>
<span><span class="co">#&gt;  the intercept, which serves as the baseline.</span></span>
<span><span class="co">#&gt;  Blue dots represent the expected values (means) for each group, and error bars capture</span></span>
<span><span class="co">#&gt;  the uncertainty associated with these estimates.</span></span>
<span><span class="co">#&gt;  The dashed purple line marks the intercept expected value.</span></span>
<span><span class="co">#&gt;  The green error bars highlight significant contrasts, with 0.1 as the threshold for the first type of error.</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-4-1.png" width="1152"></p>
<p>Here is the same plot including raw data points and the coefficient
panel:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MoPlotting</span></span>
<span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">TRUE</span>, coef <span class="op">=</span> <span class="cn">TRUE</span>, siglevel <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-5-1.png" width="1152"></p>
</div>
<div class="section level4">
<h4 id="helmert-coding">3 Helmert coding<a class="anchor" aria-label="anchor" href="#helmert-coding"></a>
</h4>
<p>Helmert coding is a contrast coding scheme where each level of a
categorical variable is compared to the mean of previous levels. The
following example uses a generated dataset (using
<code><a href="../reference/DatasetOne.html">DatasetOne()</a></code>) with Helmert contrasts. It first shows a plot
without raw data points or coefficient panel at a significance level of
0.05:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using a custom function to generate data with four groups</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DatasetOne.html">DatasetOne</a></span><span class="op">(</span>n_sample <span class="op">=</span> <span class="fl">20</span>, means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">135</span>, <span class="fl">115</span>, <span class="fl">120</span><span class="op">)</span>, sds <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">DT</span><span class="op">$</span><span class="va">Ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Ind</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Ind</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.helmert</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Dep</span> <span class="op">~</span> <span class="va">Ind</span>, data <span class="op">=</span> <span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MoPlotting sum</span></span>
<span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">FALSE</span>, coef <span class="op">=</span> <span class="cn">FALSE</span>, siglevel <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; This graphical representation depicts the linear model, with</span></span>
<span><span class="co">#&gt;  Ind as the categorical predictor (levels are represented on the x-axis),</span></span>
<span><span class="co">#&gt;  and Dep as the numerical dependent variable (values are shown on the y-axis).</span></span>
<span><span class="co">#&gt;  The applied contrast type is helmert. In this type of contrast, each group mean is compared to</span></span>
<span><span class="co">#&gt;  the cumulative mean of all previous groups.</span></span>
<span><span class="co">#&gt;  Blue dots represent the expected values (means) for the cumulative means,</span></span>
<span><span class="co">#&gt;  while orange dots represent the expected values (means) for each individual group.</span></span>
<span><span class="co">#&gt;  Error bars indicate the uncertainty associated with each expected value.</span></span>
<span><span class="co">#&gt;  The dashed purple line marks the baseline expected value.</span></span>
<span><span class="co">#&gt;  Green lines highlight significant contrasts, with 0.05 serving as the threshold for the first type of error.</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-6-1.png" width="1152"></p>
</div>
<div class="section level4">
<h4 id="reverse-helmert-coding">4 Reverse Helmert coding<a class="anchor" aria-label="anchor" href="#reverse-helmert-coding"></a>
</h4>
<p>Reverse Helmert coding compares each level to the mean of the
subsequent levels. It is the reverse of Helmert coding and can be useful
in some ordered categorical predictors. The example below uses the same
custom dataset as before with reverse Helmert contrasts, showing the
plot without raw data or coefficient panel at a 0.05 significance
level:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using Reverse Helmert coding</span></span>
<span><span class="va">ReverseHelmert</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span>, <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mat</span><span class="op">[</span><span class="va">i</span>, <span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="va">mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Ind</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReverseHelmert.html">ReverseHelmert</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Dep</span> <span class="op">~</span> <span class="va">Ind</span>, data <span class="op">=</span> <span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MoPlotting reverse Helmert</span></span>
<span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">FALSE</span>, coef <span class="op">=</span> <span class="cn">FALSE</span>, siglevel <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; This graphical representation depicts the linear model, with</span></span>
<span><span class="co">#&gt;  Ind as the categorical predictor (levels are represented on the x-axis),</span></span>
<span><span class="co">#&gt;  and Dep as the numerical dependent variable (values are shown on the y-axis).</span></span>
<span><span class="co">#&gt;  The applied contrast type is ReverseHelmert. In this type of contrast, each group mean is compared to</span></span>
<span><span class="co">#&gt;  the cumulative mean of all previous groups.</span></span>
<span><span class="co">#&gt;  Blue dots represent the expected values (means) for the cumulative means,</span></span>
<span><span class="co">#&gt;  while orange dots represent the expected values (means) for each individual group.</span></span>
<span><span class="co">#&gt;  Error bars indicate the uncertainty associated with each expected value.</span></span>
<span><span class="co">#&gt;  The dashed purple line marks the baseline expected value.</span></span>
<span><span class="co">#&gt;  Green lines highlight significant contrasts, with 0.05 serving as the threshold for the first type of error.</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-7-1.png" width="1152">
Here is the same plot including raw data points and the coefficient
panel:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">TRUE</span>, coef <span class="op">=</span> <span class="cn">TRUE</span>, siglevel <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-8-1.png" width="1152"></p>
</div>
<div class="section level4">
<h4 id="polynomial-coding">5 Polynomial coding<a class="anchor" aria-label="anchor" href="#polynomial-coding"></a>
</h4>
<p>Polynomial coding tests for trends across ordered factor levels. It
compares levels based on polynomial contrasts (linear, quadratic, cubic,
etc.). The following example uses polynomial contrasts on the custom
dataset, showing the plot without raw data or coefficients at
significance level 0.05:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using Polynomial coding</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Ind</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.poly</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Dep</span> <span class="op">~</span> <span class="va">Ind</span>, data <span class="op">=</span> <span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MoPlotting polynomial contrasts</span></span>
<span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">FALSE</span>, coef <span class="op">=</span> <span class="cn">FALSE</span>, siglevel <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-9-1.png" width="1152"><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-9-2.png" width="1152"><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-9-3.png" width="1152"></p>
<pre><code><span><span class="co">#&gt; This graphical representation illustrates the linear model, where</span></span>
<span><span class="co">#&gt;  Ind is the categorical predictor (shown on the x-axis with its levels),</span></span>
<span><span class="co">#&gt;  and Dep is the numerical dependent variable (plotted on the y-axis).</span></span>
<span><span class="co">#&gt;  The contrast type applied is poly, which decomposes the overall trend across levels into polynomial components</span></span>
<span><span class="co">#&gt;  such as linear, quadratic, and cubic trends.</span></span>
<span><span class="co">#&gt;  Each plot shows how well a trend of a given degree captures the pattern in the data.</span></span>
<span><span class="co">#&gt;  The lines interpolate the expected values based on polynomial regression,</span></span>
<span><span class="co">#&gt;  and are shown in green when the corresponding component is statistically significant (p &lt;  0.05 ).</span></span>
<span><span class="co">#&gt; [1] "Use the ARROWS to see the different plots"</span></span></code></pre>
<p>And including raw data and coefficients:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">TRUE</span>, coef <span class="op">=</span> <span class="cn">TRUE</span>, siglevel <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-10-1.png" width="1152"><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-10-2.png" width="1152"><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-10-3.png" width="1152"></p>
<pre><code><span><span class="co">#&gt; This graphical representation illustrates the linear model, where</span></span>
<span><span class="co">#&gt;  Ind is the categorical predictor (shown on the x-axis with its levels),</span></span>
<span><span class="co">#&gt;  and Dep is the numerical dependent variable (plotted on the y-axis).</span></span>
<span><span class="co">#&gt;  The contrast type applied is poly, which decomposes the overall trend across levels into polynomial components</span></span>
<span><span class="co">#&gt;  such as linear, quadratic, and cubic trends.</span></span>
<span><span class="co">#&gt;  Each plot shows how well a trend of a given degree captures the pattern in the data.</span></span>
<span><span class="co">#&gt;  The lines interpolate the expected values based on polynomial regression,</span></span>
<span><span class="co">#&gt;  and are shown in green when the corresponding component is statistically significant (p &lt;  0.05 ).</span></span>
<span><span class="co">#&gt; [1] "Use the ARROWS to see the different plots"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="sliding-difference-coding">6 Sliding Difference coding<a class="anchor" aria-label="anchor" href="#sliding-difference-coding"></a>
</h4>
<p>Sliding difference coding compares adjacent levels of the categorical
variable, useful to detect stepwise differences. The following example
applies sliding difference contrasts:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using Sliding Difference coding</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Ind</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/contr.sdif.html" class="external-link">contr.sdif</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Dep</span> <span class="op">~</span> <span class="va">Ind</span>, data <span class="op">=</span> <span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MoPlotting sliding difference contrasts</span></span>
<span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">FALSE</span>, coef <span class="op">=</span> <span class="cn">FALSE</span>, siglevel <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; This graphical representation illustrates the linear model, where</span></span>
<span><span class="co">#&gt; Ind is the categorical predictor (levels represented on the x-axis),</span></span>
<span><span class="co">#&gt; and Dep is the numerical dependent variable (values shown on the y-axis).</span></span>
<span><span class="co">#&gt; The contrast type applied is sdif, where each group mean is compared to</span></span>
<span><span class="co">#&gt; the mean of the subsequent group.</span></span>
<span><span class="co">#&gt; Blue squares represent the estimated differences (Beta) between adjacent groups;</span></span>
<span><span class="co">#&gt; green segments denote significant contrasts (p &lt; 0.05).</span></span>
<span><span class="co">#&gt; Error bars show uncertainity around each group mean; the dashed line is the intercept.</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-11-1.png" width="1152"></p>
<p>With raw data and coefficients included:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">TRUE</span>, coef <span class="op">=</span> <span class="cn">TRUE</span>, siglevel <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; This graphical representation illustrates the linear model, where</span></span>
<span><span class="co">#&gt; Ind is the categorical predictor (levels represented on the x-axis),</span></span>
<span><span class="co">#&gt; and Dep is the numerical dependent variable (values shown on the y-axis).</span></span>
<span><span class="co">#&gt; The contrast type applied is sdif, where each group mean is compared to</span></span>
<span><span class="co">#&gt; the mean of the subsequent group.</span></span>
<span><span class="co">#&gt; Blue squares represent the estimated differences (Beta) between adjacent groups;</span></span>
<span><span class="co">#&gt; green segments denote significant contrasts (p &lt; 0.05).</span></span>
<span><span class="co">#&gt; Error bars show uncertainity around each group mean; the dashed line is the intercept.</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-12-1.png" width="1152"></p>
</div>
<div class="section level4">
<h4 id="customized-coding">7 Customized coding<a class="anchor" aria-label="anchor" href="#customized-coding"></a>
</h4>
<p>MoPlotOneWay() also supports customized contrast coding schemes. You
can specify your own contrast matrix for a factor variable. Below is an
example of using custom contrasts:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define custom contrasts</span></span>
<span><span class="va">custom_contrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span>,  <span class="fl">1</span>,  <span class="fl">0</span>,</span>
<span>  <span class="fl">1</span>,  <span class="op">-</span><span class="fl">1</span>,  <span class="fl">0</span>,</span>
<span>  <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>,  <span class="fl">1</span>,</span>
<span>  <span class="op">-</span><span class="fl">1</span>,  <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span></span>
<span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">custom_contrasts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Ind</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">custom_contrasts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Ind</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">custom_contrasts</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Dep</span> <span class="op">~</span> <span class="va">Ind</span>, data <span class="op">=</span> <span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MoPlotting with customized contrasts</span></span>
<span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">FALSE</span>, coef <span class="op">=</span> <span class="cn">FALSE</span>, siglevel <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-13-1.png" width="1152"></p>
<pre><code><span><span class="co">#&gt; In Contrast_1, the contrast compares:</span></span>
<span><span class="co">#&gt; - Group 1: Gr._1, Gr._2 (Mean = 124.83, SE = 3.59, 95% CI = [117.8, 131.86])</span></span>
<span><span class="co">#&gt; - Group 2: Gr._3, Gr._4 (Mean = 121.57, SE = 3.44, 95% CI = [114.82, 128.32])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This contrast evaluates whether the mean of Gr._1, Gr._2 differs from that of Gr._3, Gr._4.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; In Contrast_2, the contrast compares:</span></span>
<span><span class="co">#&gt; - Group 1: Gr._1 (Mean = 115.78, SE = 4.96, 95% CI = [106.05, 125.5])</span></span>
<span><span class="co">#&gt; - Group 2: Gr._2 (Mean = 133.89, SE = 4.43, 95% CI = [125.21, 142.56])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This contrast evaluates whether the mean of Gr._1 differs from that of Gr._2.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; In Contrast_3, the contrast compares:</span></span>
<span><span class="co">#&gt; - Group 1: Gr._3 (Mean = 118.41, SE = 5.29, 95% CI = [108.05, 128.78])</span></span>
<span><span class="co">#&gt; - Group 2: Gr._4 (Mean = 124.73, SE = 4.44, 95% CI = [116.03, 133.43])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This contrast evaluates whether the mean of Gr._3 differs from that of Gr._4.</span></span></code></pre>
<p>With raw data and coefficient panel:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MoPlotOneWay.html">MoPlotOneWay</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="cn">TRUE</span>, coef <span class="op">=</span> <span class="cn">TRUE</span>, siglevel <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="One_Way_MoPlot_files/figure-html/unnamed-chunk-14-1.png" width="1152"></p>
<pre><code><span><span class="co">#&gt; In Contrast_1, the contrast compares:</span></span>
<span><span class="co">#&gt; - Group 1: Gr._1, Gr._2 (Mean = 124.83, SE = 3.59, 95% CI = [117.8, 131.86])</span></span>
<span><span class="co">#&gt; - Group 2: Gr._3, Gr._4 (Mean = 121.57, SE = 3.44, 95% CI = [114.82, 128.32])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This contrast evaluates whether the mean of Gr._1, Gr._2 differs from that of Gr._3, Gr._4.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; In Contrast_2, the contrast compares:</span></span>
<span><span class="co">#&gt; - Group 1: Gr._1 (Mean = 115.78, SE = 4.96, 95% CI = [106.05, 125.5])</span></span>
<span><span class="co">#&gt; - Group 2: Gr._2 (Mean = 133.89, SE = 4.43, 95% CI = [125.21, 142.56])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This contrast evaluates whether the mean of Gr._1 differs from that of Gr._2.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; In Contrast_3, the contrast compares:</span></span>
<span><span class="co">#&gt; - Group 1: Gr._3 (Mean = 118.41, SE = 5.29, 95% CI = [108.05, 128.78])</span></span>
<span><span class="co">#&gt; - Group 2: Gr._4 (Mean = 124.73, SE = 4.44, 95% CI = [116.03, 133.43])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This contrast evaluates whether the mean of Gr._3 differs from that of Gr._4.</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Umberto Granziol, Marianna Musa, Lorenzo Atzeni, Stefano Dalla Bona.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
